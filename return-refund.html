<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Return / Refund â€“ Oak & Linen</title>
<link rel="icon" type="image/png" href="https://i.postimg.cc/WbJqbhB7/Screenshot-2025-12-16-at-6-12-50-PM.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- ================= FIREBASE ================= -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore,
    doc,
    getDoc,
    updateDoc,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBI3u_ZBnh-9IpLr6I4iUNG7IDo3hzV6ds",
    authDomain: "oak-n-linen-project.firebaseapp.com",
    projectId: "oak-n-linen-project",
    storageBucket: "oak-n-linen-project.firebasestorage.app",
    messagingSenderId: "783016997772",
    appId: "1:783016997772:web:2d9e352bdcc1ad4eba1ca9"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const params = new URLSearchParams(window.location.search);
  const orderId = params.get("orderId");
  const productName = params.get("product");

  let selectedItem = null;

  window.onload = async () => {
    if (!orderId || !productName) return;

    const snap = await getDoc(doc(db, "orders", orderId));
    if (!snap.exists()) return;

    const order = snap.data();
    const item = order.items.find(i => i.product === productName);
    if (!item) return;

    selectedItem = item;

    document.getElementById("pName").innerText = item.product;
    document.getElementById("pQty").innerText = item.qty;
    document.getElementById("pPrice").innerText = "â‚¬" + item.price;
    document.getElementById("pDate").innerText =
      order.createdAt?.toDate().toLocaleDateString() || "â€”";
    document.getElementById("pStatus").innerText = order.status;
  };

  window.submitRequest = async () => {
    const type = document.getElementById("requestType").value;
    const reason = document.getElementById("reason").value.trim();

    if (!type) {
      alert("Please select a request type.");
      return;
    }

    await updateDoc(doc(db, "orders", orderId), {
      resolution: type,
      resolutionProduct: selectedItem.product,
      customerRequestNote: reason,
      resolutionRequestedAt: serverTimestamp()
    });

    alert("Your request has been submitted successfully.");
    window.location.href = "order-history.html";
  };
</script>

<!-- ================= STYLES ================= -->
<style>
*{box-sizing:border-box;font-family:"Segoe UI",Arial}
body{
  margin:0;
  background:#EFE7E1;
  color:#2B2B2B;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

#cartCount{
  background:#2E5E4E;
  color:#ffffff;
  border-radius:12px;
  padding:2px 8px;
  font-size:12px;
  margin-left:6px;
  font-weight:600;
}

/* ===== HEADER ===== */
header{
  background:#fff;
  border-bottom:4px solid #3E2723;
  padding:18px 36px;
}

.header-container{
  max-width:1200px;
  margin:auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.logo{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:22px;
  font-weight:bold;
  color:#3E2723;
  text-decoration:none;
}

.logo-icon{
  width:40px;
  height:40px;
  background:#3E2723;
  color:#C6A75E;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
}

nav a{
  margin-left:24px;
  font-weight:600;
  color:#2B2B2B;
  text-decoration:none;
}

/* ===== MAIN ===== */
main{
  flex:1;
  max-width:800px;
  margin:40px auto;
  padding:0 36px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:24px;
  box-shadow:0 8px 22px rgba(0,0,0,.08);
  margin-bottom:30px;
}

.info-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}

.info-grid div{
  background:#EFE7E1;
  padding:12px;
  border-radius:8px;
}

label{
  display:block;
  margin-top:20px;
  font-weight:600;
}

select,textarea,button{
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #ccc;
}

textarea{
  resize:vertical;
  min-height:100px;
}

button{
  margin-top:24px;
  background:#2E5E4E;
  color:#fff;
  font-weight:bold;
  border:none;
  cursor:pointer;
}

/* ===== RETURN / REFUND LAYOUT (SIDEBAR) ===== */
.refund-layout {
  display: grid;
  grid-template-columns: 260px 1fr;
  gap: 40px;

  max-width: none;
  margin: 0;
  padding: 40px 36px;
}

/* LEFT SIDEBAR */
.refund-sidebar {
  background: #fff;
  border-radius: 14px;
  padding: 24px;
  box-shadow: 0 6px 20px rgba(0,0,0,.08);
  height: fit-content;
}

.sidebar-title {
  color: #3E2723;
  margin-bottom: 20px;
  font-size: 18px;
}

/* SIDEBAR LINKS */
.sidebar-link {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 14px;
  border-radius: 10px;
  margin-bottom: 10px;
  font-weight: 600;
  color: #3E2723;
  text-decoration: none;
  transition: background .2s ease, color .2s ease;
}

.sidebar-link:hover {
  background: rgba(46, 94, 78, 0.12);
  color: #2E5E4E;
}

.sidebar-link.active {
  background: #2E5E4E;
  color: #fff;
}

/* RIGHT CONTENT */
.refund-content h1 {
  margin-top: 0;
  margin-bottom: 20px;
}

/* MOBILE */
@media (max-width: 768px) {
  .refund-layout {
    grid-template-columns: 1fr;
  }

  .refund-sidebar {
    display: flex;
    gap: 10px;
    overflow-x: auto;
  }

  .sidebar-link {
    white-space: nowrap;
    margin-bottom: 0;
  }
}


/* ===== FOOTER ===== */
footer{
  background:#3E2723;
  color:#EFE7E1;
  text-align:center;
  padding:24px;
  font-size:14px;
}

    footer {
      background:#3E2723;
      color:#EFE7E1;
      padding:50px 36px;
      font-size:14px;
    }

    .footer-container {
      max-width:1000px;
      margin:auto;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:30px;
      text-align:left;
    }

    .footer-section h4 {
      color:#C6A75E;
      margin-bottom:14px;
    }

    .footer-section a,
    .footer-section p {
      display:block;
      color:#EFE7E1;
      margin-bottom:8px;
      text-decoration:none;
    }

    .footer-section a:hover {
      text-decoration:underline;
    }

    .social a {
      margin-right:12px;
    }

    .footer-bottom {
      text-align:center;
      margin-top:30px;
      color:#D7CFC8;
      font-size:13px;
    }
</style>
</head>

<body>

<header>
  <div class="header-container">
    <a href="index.html" class="logo">
      <div class="logo-icon">OL</div> Oak & Linen
    </a>
    <nav>
      <a href="index.html">Home</a>
      <a href="products.html">Products</a>
      <a href="cart.html">ðŸ›’ Cart<span id="cartCount"></span></a>
    </nav>
  </div>
</header>

<main class="refund-layout">

  <!-- LEFT SIDEBAR -->
  <aside class="refund-sidebar">
    <h3 class="sidebar-title">Account Info</h3>

    <a href="cart.html" class="sidebar-link">
      Cart
    </a>

    <a href="order.html" class="sidebar-link">
      Place Order
    </a>

    <a href="order-history.html" class="sidebar-link">
      Order History
    </a>

    <a href="return-refund.html" class="sidebar-link active">
      Returns & Refunds
    </a>
  </aside>

  <!-- RIGHT CONTENT -->
  <section class="refund-content">

    <!-- PRODUCT INFORMATION -->
    <div class="card">
      <h1>Product Information</h1>
      <div class="info-grid">
        <div><strong>Product:</strong> <span id="pName"></span></div>
        <div><strong>Quantity:</strong> <span id="pQty"></span></div>
        <div><strong>Price:</strong> <span id="pPrice"></span></div>
        <div><strong>Order Date:</strong> <span id="pDate"></span></div>
        <div><strong>Status:</strong> <span id="pStatus"></span></div>
      </div>
    </div>

    <!-- RETURN / REFUND FORM -->
    <div class="card">
      <h2>Return / Refund / Replacement</h2>

      <label for="requestType">Request Type</label>
      <select id="requestType">
        <option value="">Select an option</option>
        <option value="Return">Return</option>
        <option value="Refund">Refund</option>
        <option value="Replacement">Replacement</option>
      </select>

      <label for="reason">Reason (optional)</label>
      <textarea id="reason" placeholder="Describe the issue with the product..."></textarea>

      <button onclick="submitRequest()">Submit Request</button>
    </div>

  </section>

</main>


<script>
  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const count = cart.reduce((sum, item) => sum + item.qty, 0);
    const badge = document.getElementById("cartCount");

    if (!badge) return;

    badge.innerText = count > 0 ? count : "";
  }

  document.addEventListener("DOMContentLoaded", updateCartCount);
</script>

<footer>
  <div class="footer-container">

    <div class="footer-section">
      <h4>Oak & Linen</h4>
      <p>Crafted furniture. Intelligent operations.</p>
    </div>

    <div class="footer-section">
      <h4>Customer Care</h4>
      <a href="#">Delivery Information</a>
      <a href="#">Returns & Refund Policy</a>
      <a href="#">Warranty & Repairs</a>
    </div>

    <div class="footer-section">
      <h4>Contact</h4>
      <a href="mailto:support@oakandlinen.ie">support@oakandlinen.ie</a>
      <a href="tel:+35315550199">+353 1 555 0199</a>
    </div>

    <div class="footer-section">
      <h4>Connect</h4>
      <div class="social">
        <a href="#">Instagram</a>
        <a href="#">Facebook</a>
        <a href="#">LinkedIn</a>
      </div>
    </div>

  </div>
  <div class="footer-bottom">
    Â© 2025 Oak & Linen Furniture. All rights reserved.
  </div>
</footer>

</body>
</html>
